## 8장 경계

> 시스템에 들어가는 모든 소프트웨어를 직접 개발하는 경우는 드물다. 때로는 패키지를 구매하고, 오픈 소스를 이용하기도 한다. 어떤 식이든 이 외부 코드를 우리 코드에 깔끔하게 통합해야 하는데 그 방법을 알아보자.

**시작하기 앞서, 이 챕터 제목인 "경계"는 무언가를 구분짓는 "경계"와**

**조심하여 단속하는 뜻의 "경계" 모두를 의미하는 것 같다.**

### 외부 코드 사용하기

외부 패키지 제공자나 프레임워크 제공자는 적용성을 최대한 넓혀야 더 많은 고객이 구매한다.

반면, 사용자는 자신의 요구에 집중하는 인터페이스를 원한다. 이런 긴장으로 인해 시스템 경계에 문제가 생길 소지가 많다.

한가지 예로, [java.util.Map](http://java.util.Map) 에서는 굉장히 다양한 인터페이스로 수많은 기능을 제공하는데, Map이 제공하는 기능성과 유연성은 확실히 유용하지만 위험도 크다. 만약 설계 시 Map에 특정 객체 유형만 저장하기로 결정했다고 결정했는데 Map은 객체 유형을 제한하지 않아서 마음만 먹으면 사용자는 어떤 객체 유형도 추가할 수 있다.

### 경계 살피고 익히기

외부 코드를 사용하면 적은 시간에 더 많은 기능을 출시하기 쉬워진다.

만약 타사 라이브러리를 가져왔으나 예상치 못한 오류를 맞이했을 경우엔 어디쪽에서 발생한 에러인지 알기 힘든경우가 있다. 외부 코드를 익히기도 어렵고, 외부 코드를 통합하기도 어렵다. 두 가지를 동시에 하기는 두 배나 더 어렵다.

하지만 먼저 간단한 테스트 케이스를 작성해서 한다면 통제된 환경에서 API를 제대로 이해하는지를 확인할 수 있다.

### 학습 테스트는 공짜 이상이다.

학습 테스트에 드는 비용은 없다. 필요한 지식만 확보하는 좋은 방법이다.

투자하는 노력보다 얻는 성과가 더 크다. 패키지 새 버전이 나온다면 학습 테스를 돌려서 차이가 있는지 확인한다.

즉 학습 테스트는 패키지가 예상대로 도는지 검증한다. 만약 새 버전이 우리코드와 호환되지 않으면

학습 테스트가 이 사실을 곧바로 밝혀내준다.

### 아직 존재하지 않는 코드를 사용하기

지금 알지 못하는 코드 영역을 개발할 때도 경계는 유용하게 쓰일 수 있다.

- 필요한 인터페이스를 정의/구현하면 전적으로 통제가 가능해진다.
- 테스트도 간편하게 진행할 수 있다.

### 깨끗한 경계

경계에서는 흥미로운 일이 많이 벌어지는데, 그 중 변경이 대표적인 예다.

소프트웨어 설계가 우수하다면 변경하는데 많은 투자가 필요치 않은데, 통제하지 못하는 코드를 사용할때는

너무 많은 투자를 하거나 변경 비용이 지나치게 커지지 않도록 주의해야한다.

또 경계에 위치하는 코드는 깔끔히 분리한다. 또한 기대치를 정의하는 테스트 케이스도 작성한다.

> **통제 불가능한 외부 패키지에 의존하는 대신 통제가 가능한 '내가 짠 코드'에 의존하는 편이 좋다.
> 자칫하면 오히려 외부 코드에 휘둘리고 만다.**
